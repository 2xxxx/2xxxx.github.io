# 作用域
作用域是指特定范围，在该范围中的变量、函数等资源具有可访问性，作用域可以隔离变量，防止泄露，不同的作用域下可定义同名变量

## 全局作用域
在代码中任何地方都能访问到的对象，该对象拥有全局作用域。

以下三种情况能拥有全局作用域：
* 最外层的函数或者是最外层函数外声明的变量
```
var str = '全局变量'
function out() {
    console.log('最外层函数')
}
```

* 未声明就直接赋值的变量，会自动声明为拥有全局变量
```
function out() {
    str = '未声明的全局变量'
}
```

* window对象的内置属性，比如window.location,window.name等等

全局作用域的弊端：会污染全局命名空间，容易命名冲突

## 函数作用域
函数作用域是指声明在函数体内的变量，该作用域变量只能在函数体范围内能访问得到。  
作用域是分层的，在嵌套函数中分为外层作用域和内层作用域，其中内作用域可以访问外作用域的变量，反之却不行。  

另外条件语句块或是循环语句块，例如if,switch,for in等等，在执行语句块("{}"中的语句)时，不会额外创建一个作用域，而是将变量保存在已存在的作用域中。

## 块级作用域
块级作用域是由let和const声明的变量，该变量只能在`{代码体}`中访问。  
块级作用域不可重复声明，否则会报错，并且声明时，不会像var置顶。


## 作用域链
在一个函数体内引用一个变量，但是该变量未在函数体中声明，于是就向父级查询，一层层往上，直到查询到为止，没查到就报错，这种一层层往上查询的关系就叫做作用域链。  

函数必定对应着自己的一个作用域链，这个作用域链是在函数声明时确定的，函数运行在声明时的作用域链上。
```
var value = 1;
function fun() {
    console.log(value)  //1
}
function fun1() {
    var value = 2;
    fun()
}

fun1()
```

# 闭包
含义：一个函数能访问到其他函数作用域中的数据。当一个函数嵌套了另一个函数，外部函数将内部的函数对象作为返回值返回时就会产生闭包。
```
var value = 1;

function fun1() {
    var value = 2;
    function fun() {
        return value  //2
    }
    return fun
}

fun1()()
```
为什么需要闭包?  
局部变量无法共享和长久的保存，而全局变量可能造成变量污染，所以我们需要有一种机制可以长久的保存变量又不会造成全局污染。  

特点：
* 占用更多内存
* 不容易被释放

使用闭包的注意点：
1. 由于闭包会使得函数中的变量都被保存在内存中，内存消耗很大，所以不能滥用闭包，否则很可能导致内存泄露。解决方法是在退出函数前将不使用的局部变量全部删除。
2. 闭包会在父函数外部改变父函数内部变量的值。